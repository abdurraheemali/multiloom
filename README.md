# Multiloom

Multiloom is a backend server for sharing [Loom](https://github.com/socketteer/loom) trees with a focus on collaborative writing. It is currently in early development and is not yet ready for use.

## Quickstart

1. Open a terminal at the root directory
2. Get the poetry package manager:

    **Linux:** 
    ```
    curl -sSL https://install.python-poetry.org | python3 -
    ```

    **Windows:**
    ```
    (Invoke-WebRequest -Uri https://install.python-poetry.org -UseBasicParsing).Content | py - 
    ```

3. Install dependencies in a virtual environment using

```
poetry install
```

4. Switch to the virtual environment using

```
poetry shell
```

5. Run the app

```
poetry run python server.py
```

## Server

The server-side code for Multiloom is contained in the `server.py` file. It defines several routes for handling HTTP requests, including creating, updating, and deleting nodes in a database, as well as retrieving all nodes after a given timestamp.

To use the server, you'll need to have a database set up and running. You'll also need to set the necessary environment variables, including `TREE_FILE`, `SERVER_PASSWORD`, and `SERVER_PORT`. If you want to load an existing tree from a JSON file, you'll also need to set the `TREE_JSON` environment variable. (This is currently only compatible with trees generated by [Loomsidian](https://github.com/cosmicoptima/loom)).

Once you have those set up, you can run the server by running the `server.py` file. The server will listen for incoming HTTP requests on the specified port.

## Routes

The following routes are defined in the `server.py` file:

- `POST /nodes`: Create a new node in the database.
- `PUT /nodes/<node_id>`: Update an existing node in the database.
- `DELETE /nodes/<node_id>`: Delete a node from the database.
- `GET /nodes/get/<timestamp>`: Retrieve all nodes from the database after a given timestamp.

## Dependencies

This file requires the following dependencies:

- `flask`: A Python web framework for handling HTTP requests.

Please note that Multiloom is currently in early development and is not yet ready for use.

## TODO

- [ ] Add support for loading Bonsai & python-Loom trees from JSON files.